{"ast":null,"code":"var _jsxFileName = \"D:\\\\Gitlab\\\\dinhngocliennhi1999_frontend\\\\src\\\\pages\\\\StorePage.js\",\n  _s = $RefreshSig$();\nimport { Alert, Grid, Typography } from \"@mui/material\";\nimport { Box, Container, Stack } from \"@mui/system\";\nimport React, { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport apiService from \"../app/apiService\";\nimport FormProvider from \"../components/form/FormProvider\";\nimport LoadingScreen from \"../components/loadingScreen/LoadingScreen\";\nimport ProductFilter from \"../features/product/ProductFilter\";\nimport ProductList from \"../features/product/ProductList\";\nimport ProductSearch from \"../features/product/ProductSearch\";\nimport ProductSort from \"../features/product/ProductSort\";\nimport \"./storepage.css\";\nimport { getAllProducts } from \"../features/product/productSlice\";\nimport orderBy from \"lodash/orderBy\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction StorePage() {\n  _s();\n  // const [products, setProducts ] = useState([]);\n  // const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const defaultValues = {\n    types: [],\n    priceRange: \"\",\n    sortBy: \"featured\",\n    searchQuery: \"\"\n  };\n  const methods = useForm({\n    defaultValues\n  });\n  const {\n    watch,\n    reset\n  } = methods;\n  // const filters = watch();\n  // const [filterName, setFilterName] = useState(\"\");\n  // const [page, setPage] = useState(1);\n\n  // const { currentPageProducts, productById, isLoading, totalProduct, isLoasing } = useSelector((state) => state.product);\n  // const dispatch = useDispatch();\n\n  // useEffect(() => {\n  //   dispatch(getProducts({}));\n  // }, [dispatch]);\n\n  // let products = currentPageProducts.map((product) => productById[product]);\n  const filterProducts = applyFilter(products, filters);\n\n  //  useEffect((name) => {\n  //       name = filterName\n  //       setTimeout(() => {\n  //           dispatch(getProducts({ page, name }));\n  //       }, 700);\n  //   }, [page, filterName, dispatch]);\n  //  useEffect(() => {\n  //     const getProducts = async () => {\n  //       setIsLoading(true);\n  //       try {\n  //         const res = await apiService.get(\"/products/public\");\n  //         console.log(\"resdata\", res.data )\n  //         setProducts(res.data.Products);\n  //         setError(\"\");\n  //       } catch (error) {\n  //         console.log(error);\n  //         setError(error.message);\n  //       }\n  //       setIsLoading(false);\n  //     };\n  //     getProducts();\n  //   }, []);\n\n  //   console.log(\"products\", products)\n\n  const dispatch = useDispatch();\n  let {\n    products,\n    filters,\n    isLoading\n  } = useSelector(state => state.product);\n  products = isLoading ? Array.from(Array(9).keys()) : products;\n  useEffect(() => {\n    dispatch(getAllProducts());\n  }, [filters, dispatch]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    sx: {\n      display: \"flex\",\n      minHeight: \"100vh\",\n      mt: 3\n    },\n    children: [/*#__PURE__*/_jsxDEV(Stack, {\n      children: /*#__PURE__*/_jsxDEV(FormProvider, {\n        methods: methods,\n        children: /*#__PURE__*/_jsxDEV(ProductFilter, {\n          resetFilter: reset\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      sx: {\n        flexGrow: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(FormProvider, {\n        methods: methods,\n        children: /*#__PURE__*/_jsxDEV(Stack, {\n          spacing: 2,\n          direction: {\n            xs: \"column\",\n            sm: \"row\"\n          },\n          alignItems: {\n            sm: \"center\"\n          },\n          justifyContent: \"space-between\",\n          mb: 2,\n          children: [/*#__PURE__*/_jsxDEV(ProductSearch, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ProductSort, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          position: \"relative\",\n          height: 1\n        },\n        children: isLoading ? /*#__PURE__*/_jsxDEV(LoadingScreen, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: error ? /*#__PURE__*/_jsxDEV(Alert, {\n            severity: \"error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(ProductList, {\n            products: filterProducts\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 17\n          }, this)\n        }, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(StorePage, \"zMDXXkmetlZIdUsTtPNDkNOlFz0=\", false, function () {\n  return [useForm, useDispatch, useSelector];\n});\n_c = StorePage;\nfunction applyFilter(filters, products) {\n  var _filters$types;\n  const {\n    sortBy\n  } = filters;\n  console.log(\"filter\", filters);\n  let filteredProducts = products;\n  console.log(\"filterProducts\", products);\n\n  // SORT BY\n\n  if (sortBy === \"priceDesc\") {\n    filteredProducts = orderBy(products, [\"price\"], [\"desc\"]);\n  }\n  if (sortBy === \"priceAsc\") {\n    filteredProducts = orderBy(products, [\"price\"], [\"asc\"]);\n  }\n\n  // FILTER PRODUCTS\n  if (((_filters$types = filters.types) === null || _filters$types === void 0 ? void 0 : _filters$types.length) > 0) {\n    filteredProducts = products.filter(product => filters.types.includes(product.types));\n  }\n  if (filters.priceRange) {\n    filteredProducts = products.filter(product => {\n      if (filters.priceRange === \"below\") {\n        return product.price < 4;\n      }\n      if (filters.priceRange === \"between\") {\n        return product.price >= 4 && product.price <= 6;\n      }\n      return product.price > 6;\n    });\n  }\n  if (filters.searchQuery) {\n    filteredProducts = products.filter(product => product.name.toLowerCase().includes(filters.searchQuery.toLowerCase()));\n  }\n  return filteredProducts;\n}\nexport default StorePage;\nvar _c;\n$RefreshReg$(_c, \"StorePage\");","map":{"version":3,"names":["Alert","Grid","Typography","Box","Container","Stack","React","useEffect","useState","useForm","apiService","FormProvider","LoadingScreen","ProductFilter","ProductList","ProductSearch","ProductSort","getAllProducts","orderBy","useDispatch","useSelector","StorePage","error","setError","defaultValues","types","priceRange","sortBy","searchQuery","methods","watch","reset","filterProducts","applyFilter","products","filters","dispatch","isLoading","state","product","Array","from","keys","display","minHeight","mt","flexGrow","xs","sm","position","height","console","log","filteredProducts","length","filter","includes","price","name","toLowerCase"],"sources":["D:/Gitlab/dinhngocliennhi1999_frontend/src/pages/StorePage.js"],"sourcesContent":["import { Alert, Grid, Typography } from \"@mui/material\";\r\nimport { Box, Container, Stack } from \"@mui/system\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport apiService from \"../app/apiService\";\r\nimport FormProvider from \"../components/form/FormProvider\";\r\nimport LoadingScreen from \"../components/loadingScreen/LoadingScreen\";\r\nimport ProductFilter from \"../features/product/ProductFilter\";\r\nimport ProductList from \"../features/product/ProductList\";\r\nimport ProductSearch from \"../features/product/ProductSearch\";\r\nimport ProductSort from \"../features/product/ProductSort\";\r\nimport \"./storepage.css\";\r\nimport {getAllProducts} from \"../features/product/productSlice\";\r\nimport orderBy from \"lodash/orderBy\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\n\r\nfunction StorePage() {\r\n\r\n  // const [products, setProducts ] = useState([]);\r\n  // const [isLoading, setIsLoading] = useState(true);\r\n  const [ error, setError ] = useState(\"\");\r\n\r\n  const defaultValues = {\r\n    types: [],\r\n    priceRange: \"\",\r\n    sortBy: \"featured\",\r\n    searchQuery: \"\"\r\n  };\r\n\r\n  const methods = useForm({\r\n    defaultValues,\r\n  });\r\n\r\n  const { watch, reset } = methods;\r\n  // const filters = watch();\r\n  // const [filterName, setFilterName] = useState(\"\");\r\n  // const [page, setPage] = useState(1);\r\n\r\n  // const { currentPageProducts, productById, isLoading, totalProduct, isLoasing } = useSelector((state) => state.product);\r\n  // const dispatch = useDispatch();\r\n\r\n  // useEffect(() => {\r\n  //   dispatch(getProducts({}));\r\n  // }, [dispatch]);\r\n\r\n  // let products = currentPageProducts.map((product) => productById[product]);\r\n  const filterProducts = applyFilter(products, filters);\r\n\r\n  //  useEffect((name) => {\r\n  //       name = filterName\r\n  //       setTimeout(() => {\r\n  //           dispatch(getProducts({ page, name }));\r\n  //       }, 700);\r\n  //   }, [page, filterName, dispatch]);\r\n//  useEffect(() => {\r\n//     const getProducts = async () => {\r\n//       setIsLoading(true);\r\n//       try {\r\n//         const res = await apiService.get(\"/products/public\");\r\n//         console.log(\"resdata\", res.data )\r\n//         setProducts(res.data.Products);\r\n//         setError(\"\");\r\n//       } catch (error) {\r\n//         console.log(error);\r\n//         setError(error.message);\r\n//       }\r\n//       setIsLoading(false);\r\n//     };\r\n//     getProducts();\r\n//   }, []);\r\n\r\n//   console.log(\"products\", products)\r\n\r\nconst dispatch = useDispatch();\r\n  let { products, filters, isLoading } = useSelector((state) => state.product);\r\n  products = isLoading ? Array.from(Array(9).keys()) : products;\r\n\r\n  useEffect(() => {\r\n    dispatch(getAllProducts());\r\n  }, [filters, dispatch]);\r\n\r\n  return (\r\n \r\n\r\n  \r\n    <Container sx={{ display: \"flex\", minHeight: \"100vh\", mt: 3 }}>\r\n      \r\n      <Stack>\r\n        <FormProvider methods={methods}>\r\n          <ProductFilter resetFilter={reset} />\r\n        </FormProvider>\r\n      </Stack>\r\n      <Stack sx={{ flexGrow: 1 }}>\r\n        <FormProvider methods={methods}>\r\n          <Stack\r\n            spacing={2}\r\n            direction={{ xs: \"column\", sm: \"row\" }}\r\n            alignItems={{ sm: \"center\" }}\r\n            justifyContent=\"space-between\"\r\n            mb={2}\r\n          >\r\n            <ProductSearch/>\r\n           \r\n            <ProductSort />\r\n          </Stack>\r\n        </FormProvider>\r\n        <Box sx={{ position: \"relative\", height: 1 }}>\r\n          {isLoading ? (\r\n            <LoadingScreen />\r\n          ) : (\r\n            <>\r\n              {error ? (\r\n                <Alert severity=\"error\">{error}</Alert>\r\n              ) : (\r\n                <ProductList products={filterProducts} />\r\n               )}\r\n            </>\r\n          )}\r\n        </Box>\r\n      </Stack>\r\n    </Container>\r\n   \r\n  );\r\n\r\n}\r\n\r\nfunction applyFilter(filters, products) {\r\n  const { sortBy } = filters;\r\n  console.log(\"filter\", filters)\r\n\r\n  let filteredProducts = products;\r\n  console.log(\"filterProducts\", products)\r\n\r\n\r\n  // SORT BY\r\n \r\n  if (sortBy === \"priceDesc\") {\r\n    filteredProducts = orderBy(products, [\"price\"], [\"desc\"]);\r\n  }\r\n  if (sortBy === \"priceAsc\") {\r\n    filteredProducts = orderBy(products, [\"price\"], [\"asc\"]);\r\n  }\r\n\r\n  // FILTER PRODUCTS\r\n  if (filters.types?.length > 0) {\r\n   \r\n    filteredProducts = products.filter((product) =>\r\n      filters.types.includes(product.types)\r\n    );\r\n  }\r\n  \r\n  if (filters.priceRange) {\r\n    filteredProducts = products.filter((product) => {\r\n      if (filters.priceRange === \"below\") {\r\n        return product.price < 4;\r\n      }\r\n      if (filters.priceRange === \"between\") {\r\n        return product.price >= 4 && product.price <= 6;\r\n      }\r\n      return product.price > 6 ;\r\n    });\r\n  }\r\n  if (filters.searchQuery) {\r\n    filteredProducts = products.filter((product) =>\r\n      product.name.toLowerCase().includes(filters.searchQuery.toLowerCase())\r\n    );\r\n  }\r\n  return filteredProducts;\r\n}\r\n\r\nexport default StorePage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}